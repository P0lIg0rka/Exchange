# Exchange

## Сервер

Для сборки проекта создал простой файл build.sh запуск которого создаёт папку build со всеми бинарниками

Для запуска сервера используйте команду.

```bash
./build/src/Server port_name
```

Параметр port_name отвечает за поднимаемый сервер (test/prod)


Основную логику заявок я реализовал при помощи двух односвязных списков (для продажи и для покупки) с отсортированными по цене и времени подачи значениями. Таким образом при поступлении очередной заявки все подходящие к ней будут находиться в начале того или иного списка. В худшем случае алгоритм работает за O(число активных заявок), когда сделок не совершается. Но само совершение сделок проходит за О(число совершённых сделок), что довольно быстро, так как все самые подходящие заявки расположены в начале списка подряд. Это гораздо полезнее, так как запросы с изменением баланса будут обрабатываться быстрее.


Сервер работает ассинхронно, а библиотека boost::asio гарантирует, что функции обратного вызова будут запущены только в том потоке, откуда вызвана io_service::run(), значит и гонок памяти не будет.


В дальнейшем можно было бы создать несколько потоков обработчиков запросов в сервер (добавив RWmutex для безопасного обращения к Core), но и асинхронная версия способна обрабатывать довольно много подключений одновременно и не вызывает лишних прерываний для мьютекса.


---

## Клиент

Для запуска клиента используйте команду

```bash
./build/src/Client
```

Клиенту добавил две основные функции:
- Balance выводит в std::cout информацию о балансе пользователя как в рублях, так и в долларах
- CreateBid по введённым пользователем данным создаёт сделку и выводит отчёт о её совершении. Если от заявки что-то осталось, то также появляется надпись "Bid Created".


---

## Тесты

Для запуска тестов используйте команду

```bash
./build/test/Tests
```


Тесты реализовал с помощью фреймворка googletest, так как имел положительный опыт работы с ним, а также, в отличии от boost::test, проект бурно развивается.


Всего создал два основных теста:
- logic_test.cpp на проверку логики работы приложения, корректного создания заявок и их обработки
- multy_client_test.cpp на проверку поддержания нескольких клиентов одновременно


Перед запуском тестов обязательно убедитесь, что тестовый сервер запущен, иначе не получится подключиться к нему и все тесты упадут.


---

## Итого


- [x] Клиент представляет собой обычное консольное приложение.
- [x] Все основные торговые сценарии на сервере покрыты тестами:
- [x] Проект написан с использованием C++17.
- [x] Проект собирается с использованием CMake.
- [x] В проекте используется сторонняя библиотека.
- [x] Описание, инструкция по сборке и инструкция по использованию проекта есть в файле README.md
- [x] Проект выполнен в git-репозитории